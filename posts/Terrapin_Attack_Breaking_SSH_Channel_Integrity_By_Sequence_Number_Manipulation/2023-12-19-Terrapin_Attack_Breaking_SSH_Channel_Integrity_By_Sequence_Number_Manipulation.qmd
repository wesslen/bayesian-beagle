
---
title: "Terrapin Attack: Breaking SSH Channel Integrity By Sequence Number Manipulation"
id: "2312.12422v1"
description: "SSH protocol vulnerabilities allow attackers to break channel integrity and downgrade security measures, affecting millions of servers."
author: ['Fabian Bäumer', 'Marcus Brinkmann', 'Jörg Schwenk']
date: "2023-12-19"
image: "https://browse.arxiv.org/html/2312.12422v1/x1.png"
categories: ['security']
format:
  html:
    code-overflow: wrap
---

![](https://browse.arxiv.org/html/2312.12422v1/x1.png)

### Major Takeways:

1. **SSH Channel Integrity Broken:** The paper demonstrates that the secure channel in SSH is no longer secure for three widely used encryption modes, allowing an attacker to delete encrypted packets from the beginning of the channel without detection.

2. **Extension Negotiation Downgrade Attack:** The paper shows a practical attack that downgrades the security of the SSH connection by removing the ExtInfo message from the secure channel using prefix truncation.

3. **Identification of Vulnerable SSH Servers:** An internet-wide scan reveals that a significant percentage of SSH servers support exploitable encryption modes, highlighting the widespread vulnerability.

### Introduction

The introduction provides an overview of the SSH protocol, its purpose, and its historical development. It outlines the significance of SSH in internet security and its relevance even after 25 years without major redesign.

### SSH Channel Security

- The paper focuses on the integrity of the SSH handshake and the resulting secure channel.
- It identifies technical observations about how SSH protects the integrity of the handshake and channel.

### Breaking SSH Channel Integrity

- The prefix truncation attack on the SSH Binary Packet Protocol is described, with specific techniques outlined for single message and multiple message prefix truncation attacks.
- The analysis of vulnerability and exploitability of different encryption modes is presented, with specific attention to GCM, CBC-EaM, CTR-EtM, ChaCha20-Poly1305, and CTR-EtM.

### SSH Extension Negotiation

- The process and significance of SSH extension negotiation, as outlined in RFC 8308, are explained.
- The relevant protocol extensions are defined, including server-sig-algs, publickey-hostbound@openssh.com, and ping@openssh.com.

### Extension Downgrade Attack

- The attack on SSH extension negotiation is detailed, showing how the prefix truncation attack can be applied to delete the ExtInfo message without detection.
- Two different strategies are presented for the extension downgrade attack, depending on the encryption mode used.

### Related Work and Artifacts

- The related work section highlights previous research on secure channels, truncation attacks, and formal proofs for SSH, providing context for the paper's findings.
- The mention of artifacts, including proof-of-concept implementations and internet-wide scan results, emphasizes the practical implications and technical validity of the paper's findings.

### Critique:

- The paper comprehensively analyzes the vulnerabilities in SSH, but there could be a clearer demonstration of the real-world impact of these attacks. Demonstrating the severity of potential exploitation and the practical implications would make the findings more compelling.
- Additionally, while the paper provides a detailed breakdown of the attacks and potential exploits, further discussion on potential mitigations or countermeasures for these vulnerabilities would enhance the overall contribution. Addressing potential solutions or next steps for addressing these vulnerabilities would be valuable for the reader.

## Appendix

|          |          |
|----------|----------|
| Model     | gpt-3.5-turbo-1106       |
| Date Generated     | 2024-01-31       |
| Abstract | [http://arxiv.org/abs/2312.12422v1](http://arxiv.org/abs/2312.12422v1)        |
| HTML     | [https://browse.arxiv.org/html/2312.12422v1](https://browse.arxiv.org/html/2312.12422v1)       |
| Truncated       | True       |
| Word Count       | 18928       |